<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<title>Image Search</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,600,0,0&display=swap" rel="stylesheet" />
<style>
  :root { --bg: #F9F5EC; --surface: rgba(255,255,255,0.6); --radius: 9999px; }
  body { margin:0; background: var(--bg); font-family:'Inter',sans-serif; color:#333; padding-bottom:120px; }
  .grid { column-count:2; column-gap:8px; padding:8px; }
  .item { break-inside: avoid; margin-bottom:8px; opacity:0; transform:translateY(20px) translateX(var(--slide,0)); filter:blur(10px); transition:opacity .6s ease, transform .6s ease, filter .6s ease; }
  .item.visible { opacity:1; transform:translateY(0) translateX(0); filter:blur(0); }
  .controls { position:fixed; left:50%; bottom:calc(env(safe-area-inset-bottom,0px) + 16px); transform:translateX(-50%); display:flex; gap:8px; width:calc(100% - 32px); max-width:500px; z-index:10; }
  .pill { flex:1; height:48px; border:none; border-radius:var(--radius); background:var(--surface); padding:0 16px; font-size:16px; outline:none; backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px); transition:box-shadow .2s ease; }
  .pill:focus { box-shadow:0 4px 12px rgba(0,0,0,0.1); }
  .btn { width:48px; height:48px; border:none; border-radius:var(--radius); background:var(--surface); display:flex; align-items:center; justify-content:center; backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px); transition:transform .2s cubic-bezier(.2,.8,.4,1), box-shadow .2s ease; }
  .btn:focus { box-shadow:0 4px 12px rgba(0,0,0,0.1); outline:none; }
  .btn:active, .pill:active { transform:scale(.96); }
  .material-symbols-rounded { font-variation-settings:'FILL' 0,'wght' 600,'GRAD' 0,'opsz' 24; }
  @media (prefers-reduced-motion: reduce) { .item { transition:opacity .5s ease; transform:none !important; filter:none !important; } .btn, .pill { transition:none; } }
</style>
</head>
<body>
<div id="results" class="grid"></div>
<form id="searchForm" class="controls" onsubmit="return false">
  <input id="query" class="pill" placeholder="Search" type="text" />
  <button id="go" class="btn" aria-label="Search">
    <span class="material-symbols-rounded">search</span>
  </button>
</form>
<script>
let page=1, query='', loading=false, end=false;
const results=document.getElementById('results');
const input=document.getElementById('query');
const form=document.getElementById('searchForm');
function clearResults(){results.innerHTML=''; page=1; end=false;}
async function fetchImages(){
  if(loading||end||!query) return;
  loading=true;
  try{
    const resp=await fetch(`https://api.openverse.org/v1/images/?q=${encodeURIComponent(query)}&page=${page}&page_size=20`);
    if(!resp.ok) throw new Error('net');
    const data=await resp.json();
    if(!data.results.length){end=true;}
    data.results.forEach((img,i)=>{
      const el=document.createElement('img');
      el.src=img.thumbnail||img.url;
      el.alt=img.title||'';
      el.className='item';
      el.style.setProperty('--slide', ((page*20+i)%2? '20px' : '-20px'));
      el.style.transitionDelay = (i*40)+'ms';
      results.appendChild(el);
      requestAnimationFrame(()=>{requestAnimationFrame(()=>{el.classList.add('visible');});});
    });
    page++;
  }catch(e){console.error(e);}
  loading=false;
}
form.addEventListener('submit',()=>{query=input.value.trim();clearResults();fetchImages();});
window.addEventListener('scroll',()=>{if(window.innerHeight+window.scrollY>document.body.offsetHeight-200) fetchImages();});
</script>
</body>
</html>
